"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./src/middleware.js":
/*!***************************!*\
  !*** ./src/middleware.js ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n\n// 不需要鉴权的路径\nconst publicPaths = [\n    '/',\n    '/login',\n    '/share',\n    '/api/auth'\n];\n// 检查是否为公开路径\nfunction isPublicPath(pathname) {\n    return publicPaths.some((path)=>pathname === path || pathname.startsWith(`${path}/`));\n}\nfunction middleware(request) {\n    const { pathname } = request.nextUrl;\n    // 如果是公开路径，直接放行\n    if (isPublicPath(pathname)) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // 检查 Cookie 中是否有 auth_token\n    const authToken = request.cookies.get('auth_token')?.value;\n    if (!authToken) {\n        // 如果没有 token，重定向到登录页\n        const loginUrl = new URL('/login', request.url);\n        // 添加重定向参数，登录后可以跳转回原页面\n        loginUrl.searchParams.set('redirect', pathname);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(loginUrl);\n    }\n    // 有 token，继续访问\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n}\nconst config = {\n    matcher: [\n        /*\n     * 匹配所有路径，除了：\n     * - _next/static (静态文件)\n     * - _next/image (图片优化)\n     * - favicon.ico (网站图标)\n     * - public 文件夹\n     */ '/((?!_next/static|_next/image|favicon.ico).*)'\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vc3JjL21pZGRsZXdhcmUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTBDO0FBRTFDLFdBQVc7QUFDWCxNQUFNQyxjQUFjO0lBQUM7SUFBSztJQUFVO0lBQVU7Q0FBWTtBQUUxRCxZQUFZO0FBQ1osU0FBU0MsYUFBYUMsUUFBUTtJQUM1QixPQUFPRixZQUFZRyxJQUFJLENBQUNDLENBQUFBLE9BQ3RCRixhQUFhRSxRQUFRRixTQUFTRyxVQUFVLENBQUMsR0FBR0QsS0FBSyxDQUFDLENBQUM7QUFFdkQ7QUFFTyxTQUFTRSxXQUFXQyxPQUFPO0lBQ2hDLE1BQU0sRUFBRUwsUUFBUSxFQUFFLEdBQUdLLFFBQVFDLE9BQU87SUFFcEMsZUFBZTtJQUNmLElBQUlQLGFBQWFDLFdBQVc7UUFDMUIsT0FBT0gscURBQVlBLENBQUNVLElBQUk7SUFDMUI7SUFFQSw0QkFBNEI7SUFDNUIsTUFBTUMsWUFBWUgsUUFBUUksT0FBTyxDQUFDQyxHQUFHLENBQUMsZUFBZUM7SUFFckQsSUFBSSxDQUFDSCxXQUFXO1FBQ2QscUJBQXFCO1FBQ3JCLE1BQU1JLFdBQVcsSUFBSUMsSUFBSSxVQUFVUixRQUFRUyxHQUFHO1FBQzlDLHNCQUFzQjtRQUN0QkYsU0FBU0csWUFBWSxDQUFDQyxHQUFHLENBQUMsWUFBWWhCO1FBQ3RDLE9BQU9ILHFEQUFZQSxDQUFDb0IsUUFBUSxDQUFDTDtJQUMvQjtJQUVBLGVBQWU7SUFDZixPQUFPZixxREFBWUEsQ0FBQ1UsSUFBSTtBQUMxQjtBQUVPLE1BQU1XLFNBQVM7SUFDcEJDLFNBQVM7UUFDUDs7Ozs7O0tBTUMsR0FDRDtLQUNEO0FBQ0gsRUFBQyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxwZWFjaFxcRGVza3RvcFxcbm90ZXNcXG5vdGVzXFxzcmNcXG1pZGRsZXdhcmUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5cbi8vIOS4jemcgOimgemJtOadg+eahOi3r+W+hFxuY29uc3QgcHVibGljUGF0aHMgPSBbJy8nLCAnL2xvZ2luJywgJy9zaGFyZScsICcvYXBpL2F1dGgnXVxuXG4vLyDmo4Dmn6XmmK/lkKbkuLrlhazlvIDot6/lvoRcbmZ1bmN0aW9uIGlzUHVibGljUGF0aChwYXRobmFtZSkge1xuICByZXR1cm4gcHVibGljUGF0aHMuc29tZShwYXRoID0+XG4gICAgcGF0aG5hbWUgPT09IHBhdGggfHwgcGF0aG5hbWUuc3RhcnRzV2l0aChgJHtwYXRofS9gKVxuICApXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtaWRkbGV3YXJlKHJlcXVlc3QpIHtcbiAgY29uc3QgeyBwYXRobmFtZSB9ID0gcmVxdWVzdC5uZXh0VXJsXG5cbiAgLy8g5aaC5p6c5piv5YWs5byA6Lev5b6E77yM55u05o6l5pS+6KGMXG4gIGlmIChpc1B1YmxpY1BhdGgocGF0aG5hbWUpKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KClcbiAgfVxuXG4gIC8vIOajgOafpSBDb29raWUg5Lit5piv5ZCm5pyJIGF1dGhfdG9rZW5cbiAgY29uc3QgYXV0aFRva2VuID0gcmVxdWVzdC5jb29raWVzLmdldCgnYXV0aF90b2tlbicpPy52YWx1ZVxuXG4gIGlmICghYXV0aFRva2VuKSB7XG4gICAgLy8g5aaC5p6c5rKh5pyJIHRva2Vu77yM6YeN5a6a5ZCR5Yiw55m75b2V6aG1XG4gICAgY29uc3QgbG9naW5VcmwgPSBuZXcgVVJMKCcvbG9naW4nLCByZXF1ZXN0LnVybClcbiAgICAvLyDmt7vliqDph43lrprlkJHlj4LmlbDvvIznmbvlvZXlkI7lj6/ku6Xot7Povazlm57ljp/pobXpnaJcbiAgICBsb2dpblVybC5zZWFyY2hQYXJhbXMuc2V0KCdyZWRpcmVjdCcsIHBhdGhuYW1lKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobG9naW5VcmwpXG4gIH1cblxuICAvLyDmnIkgdG9rZW7vvIznu6fnu63orr/pl65cbiAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KClcbn1cblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgbWF0Y2hlcjogW1xuICAgIC8qXG4gICAgICog5Yy56YWN5omA5pyJ6Lev5b6E77yM6Zmk5LqG77yaXG4gICAgICogLSBfbmV4dC9zdGF0aWMgKOmdmeaAgeaWh+S7tilcbiAgICAgKiAtIF9uZXh0L2ltYWdlICjlm77niYfkvJjljJYpXG4gICAgICogLSBmYXZpY29uLmljbyAo572R56uZ5Zu+5qCHKVxuICAgICAqIC0gcHVibGljIOaWh+S7tuWkuVxuICAgICAqL1xuICAgICcvKCg/IV9uZXh0L3N0YXRpY3xfbmV4dC9pbWFnZXxmYXZpY29uLmljbykuKiknLFxuICBdLFxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJwdWJsaWNQYXRocyIsImlzUHVibGljUGF0aCIsInBhdGhuYW1lIiwic29tZSIsInBhdGgiLCJzdGFydHNXaXRoIiwibWlkZGxld2FyZSIsInJlcXVlc3QiLCJuZXh0VXJsIiwibmV4dCIsImF1dGhUb2tlbiIsImNvb2tpZXMiLCJnZXQiLCJ2YWx1ZSIsImxvZ2luVXJsIiwiVVJMIiwidXJsIiwic2VhcmNoUGFyYW1zIiwic2V0IiwicmVkaXJlY3QiLCJjb25maWciLCJtYXRjaGVyIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.js\n");

/***/ })

});